<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "mybatis-3-mapper.dtd">
<mapper namespace="com.sds.weatherapp.model.local.StoryDAO">

	<insert id="insert" parameterType="Story">
		insert into story(member_idx, content, filename, place_name, road_address, dong, x, y)
		values(#{member.member_idx}, #{content}, #{filename}, #{place_name}, #{roadAddress}, #{dong}, #{x}, #{y})
	</insert>
	
	<select id="selectByMember" parameterType="String" resultType="Story">
		select DISTINCT place_name,x,y from story where dong=#{dong}
	</select>
	
	<select id="selectByXY" parameterType="Story" resultType="Story">
		select * from story where x = #{x} and y = #{y}
	</select>
	
	<resultMap type="Story" id="StoryMap">
		<id column="story_idx" property="story_idx"/>
		<result column="content" property="content"/>
		<result column="filename" property="filename"/>
		<result column="place_name" property="place_name"/>
		<result column="road_address" property="roadAddress"/>
		<result column="dong" property="dong"/>
		<result column="x" property="x"/>
		<result column="y" property="y"/>
		<association column="member_idx" property="member"
			javaType="Member" select="com.sds.weatherapp.model.member.MemberDAO.selectByMemberIdx"/>
		
	
	</resultMap>
	<select id="selectByPlaceName" parameterType="String" resultMap="StoryMap">
		select * from story where place_name=#{place_name}
	</select>
</mapper>